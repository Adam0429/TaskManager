(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2134e7"],{abb2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"log-trace"},[a("page-header",[a("div",{staticClass:"page-header-content-view"},[a("div",{staticClass:"content"},[e._v("\n        "+e._s(e.$t("LogTrace.logTraceDescription"))+"\n      ")])])]),a("div",{staticClass:"app-wrapper"},[a("a-card",{staticClass:"emq-list-card"},[a("div",{staticClass:"emq-table-header"},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){return e.handleDialogOpen("create")}}},[e._v("\n          "+e._s(e.$t("LogTrace.createTrace"))+"\n        ")])],1),a("el-table",{staticClass:"data-list",attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("LogTrace.filter")}}),a("el-table-column",{attrs:{prop:"type",label:e.$t("LogTrace.type")}}),a("el-table-column",{attrs:{prop:"level",label:e.$t("LogTrace.level")}}),a("el-table-column",{attrs:{width:"250px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"dashed",size:"mini"},on:{click:function(t){return e.handleDialogOpen("view",n)}}},[e._v(e._s(e.$t("Overview.view"))+"\n            ")]),a("el-button",{attrs:{type:"dashed",size:"mini"},on:{click:function(t){return e.handleDownload(n)}}},[e._v("\n              "+e._s(e.$t("Backup.download"))+"\n            ")]),a("el-button",{attrs:{type:"dashed danger",loading:"deleteBtn"===e.btnLoading,size:"mini"},on:{click:function(t){return e.deleteConfirm(n)}}},[e._v("\n              "+e._s(e.$t("General.delete"))+"\n            ")])]}}])})],1)],1)],1),a("el-dialog",{attrs:{width:"520px",title:"view"===e.accessType?e.$t("LogTrace.viewTrace"):e.$t("LogTrace.createTrace"),visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t},close:e.clearInput}},[a("el-form",{ref:"recordForm",attrs:{size:"small",model:e.record,rules:"view"===e.accessType?{}:e.rules}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"type",label:e.$t("LogTrace.type")}},[a("emq-select",{attrs:{field:{options:e.typeOptions},disabled:"create"!==e.accessType},model:{value:e.record.type,callback:function(t){e.$set(e.record,"type",t)},expression:"record.type"}},[e._v(">\n            ")])],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"level",label:e.$t("LogTrace.level")}},[a("emq-select",{attrs:{field:{list:e.levelOptions},disabled:"create"!==e.accessType},model:{value:e.record.level,callback:function(t){e.$set(e.record,"level",t)},expression:"record.level"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"name",label:e.$t("LogTrace.filter")}},[a("el-input",{attrs:{readonly:"create"!==e.accessType},model:{value:e.record.name,callback:function(t){e.$set(e.record,"name",t)},expression:"record.name"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"file",label:e.$t("LogTrace.logPath")}},[a("el-input",{attrs:{readonly:"create"!==e.accessType},model:{value:e.record.file,callback:function(t){e.$set(e.record,"file",t)},expression:"record.file"}})],1)],1)],1)],1),"create"===e.accessType?a("div",{staticClass:"dialog-align-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{plain:"",size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(e._s(e.$t("Base.cancel")))]),a("el-button",{attrs:{loading:"createBtn"===e.btnLoading,type:"primary",size:"small"},on:{click:e.handleCreateTrace}},[e._v("\n        "+e._s(e.$t("Base.confirm"))+"\n      ")])],1):e._e()],1)],1)},r=[],l=(a("7f7f"),a("cebc")),c=(a("96cf"),a("3b8d")),s=a("1f75");function i(){return s["a"].get("/log/trace")}function o(e){return s["a"].post("/log/trace",e)}function d(e,t){return s["a"].delete("/log/trace/".concat(e,"/").concat(t))}var u={name:"LogTrace",data:function(){return{tableData:[],dialogVisible:!1,accessType:"",record:{},rules:{type:[{required:!0,message:this.$t("General.pleaseChoose")}],name:[{required:!0,message:this.$t("General.pleaseEnter")}],level:[{required:!0,message:this.$t("General.pleaseChoose")}]},typeOptions:[{label:this.$t("Clients.clientId"),value:"clientid"},{label:this.$t("Subs.topic"),value:"topic"}],levelOptions:["debug","info","notice","warning","error","critical","alert","emergency"],btnLoading:void 0}},methods:{loadList:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:this.tableData=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleDialogOpen:function(e,t){this.accessType=e,this.dialogVisible=!0,"view"===e&&(this.record=Object(l["a"])({},t))},clearInput:function(){this.$refs.recordForm&&this.$refs.recordForm.resetFields()},handleSuccess:function(){this.btnLoading=void 0,this.loadList()},handleCreateTrace:function(){var e=this;this.$refs.recordForm.validate(function(t){if(t){e.btnLoading="createBtn";var a=Object.assign({},e.record);o(a).then(function(){e.$message.success(e.$t("Base.createSuccess")),e.dialogVisible=!1,e.handleSuccess()}).catch(function(){e.btnLoading=void 0})}})},deleteConfirm:function(e){var t=this;this.$confirm(this.$t("Modules.confirmDelete"),this.$t("Base.warning"),{type:"warning",cancelButtonText:this.$t("Base.cancel"),confirmButtonText:this.$t("Base.confirm")}).then(function(){t.btnLoading="deleteBtn";var a=e.type,n=e.name;d(a,n).then(function(){t.$message.success(t.$t("Base.deleteSuccess")),t.handleSuccess()})}).catch(function(){t.btnLoading=void 0})},handleDownload:function(e){var t=e.type,a=e.name,n=document.createElement("a");n.download="".concat(t,"/").concat(a),n.href="/api/v4/log/trace/download/".concat(t,"/").concat(a),n.setAttribute("type","hidden"),document.body.appendChild(n),n.click(),n.remove()}},created:function(){this.loadList()}},p=u,f=a("2877"),m=Object(f["a"])(p,n,r,!1,null,null,null);t["default"]=m.exports}}]);